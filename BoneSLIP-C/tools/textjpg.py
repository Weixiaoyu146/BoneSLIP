import wordcloud
from matplotlib import pyplot as plt
import seaborn as sns
import numpy as np
import jieba

def wordcloudraw():
    # wcd = wordcloud.WordCloud(font_path=r"C:\Users\wxy\Desktop\paper\Nature Medicine\simhei.ttf", background_color='white')
    wcd = wordcloud.WordCloud(background_color='white')
    # text = open(r'C:\Users\wxy\Desktop\paper\Nature Medicine\LIBS-160k_label_cn.txt', 'r', encoding='UTF-8').read()
    text = open(r'C:\Users\wxy\Desktop\paper\Nature Medicine\LIBS-160k_label_en.txt', 'r', encoding='UTF-8').read()
    # text = "\n".join(jieba.cut(text))
    print(text)
    # 生成词云
    wcd.generate(text)  # Generate  wordcloud from text.
    wcd.to_image()
    plt.imshow(wcd)
    plt.axis('off')
    plt.show()

def heatmap():
    BLIP = np.array([[2464, 2464, 2463, 2462, 2442, 2441, 2480, 2463, 2464, 2476, 2480, 2480, 2480],
                     [2, 2, 142, 148, 6, 11, 75, 16, 17, 266, 70, 77, 235],
                     [2462, 2462, 2321, 2314, 2436, 2430, 2405, 2447, 2447, 2210, 2410, 2403, 2245]])
    BLIP_F1 = [0.555649598, 0.590112884, 0.508574491, 0.713446579, 0.378217285, 0.503728958, 0.949081164, 0.49823143, 0.529632721, 0.968132942, 0.543167028, 0.605352431, 0.967875648]
    x_labels = ['left ankle joint', 'right ankle joint', 'left chest', 'right chest', 'left elbow joint', 'right elbow joint', 'head', 'left knee joint', 'right knee joint', 'pelvis', 'left shoulder joint', 'right shoulder joint', 'vertebra']
    y_labels = ['n images', 'n abnormal', 'n normal']
    plt.figure(figsize=(8, 4))
    pic = sns.heatmap(BLIP, vmin=2, vmax=500, annot=True, fmt='d', cmap='YlGnBu', xticklabels=x_labels, yticklabels=y_labels)
    # plt.title('Confusion Matrix')
    # plt.xlabel('Predicted Labels')
    # plt.ylabel('True Labels')
    plt.axis('off')
    plt.show()

def confusion_matrix_heatmap():
    x_labels = ['$ankleL_a$', '$ankleL_n$', '$ankleR_a$', '$ankleR_n$', '$chestL_a$', '$chestL_n$', '$chestR_a$',
                '$chestR_n$', '$elbowL_a$', '$elbowL_n$', '$elbowR_a$', '$elbowR_n$', '$head_a$', '$head_n$',
                '$kneeL_a$', '$kneeL_n$', '$kneeR_a$', '$kneeR_n$', '$pelvis_a$', '$pelvis_n$', '$shoulderL_a$',
                '$shoulderL_n$', '$shoulderR_a$', '$shoulderR_n$', '$vertebra_a$', '$vertebra_n$']
    y_labels = ['$ankleL_a$', '$ankleL_n$', '$ankleR_a$', '$ankleR_n$', '$chestL_a$', '$chestL_n$', '$chestR_a$',
                '$chestR_n$', '$elbowL_a$', '$elbowL_n$', '$elbowR_a$', '$elbowR_n$', '$head_a$', '$head_n$',
                '$kneeL_a$', '$kneeL_n$', '$kneeR_a$', '$kneeR_n$', '$pelvis_a$', '$pelvis_n$', '$shoulderL_a$',
                '$shoulderL_n$', '$shoulderR_a$', '$shoulderR_n$', '$vertebra_a$', '$vertebra_n$']

    blip_EN = [[1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 1735, 0, 44, 2, 18, 0, 1, 0, 152, 0, 58, 1, 4, 0, 225, 0, 101, 1, 0, 4, 29, 2, 62, 8, 15],
            [0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 1436, 0, 278, 2, 8, 0, 4, 0, 123, 0, 58, 2, 11, 0, 255, 1, 139, 0, 0, 5, 32, 6, 87, 2, 13],
            [0, 0, 0, 0, 100, 17, 4, 17, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 71, 0, 4, 77, 1489, 58, 547, 0, 2, 0, 1, 0, 31, 0, 19, 0, 7, 1, 0, 0, 1, 0, 2, 0, 10],
            [0, 0, 0, 2, 3, 27, 86, 28, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
            [0, 30, 0, 4, 69, 855, 56, 1255, 0, 0, 0, 0, 0, 25, 0, 6, 0, 3, 0, 0, 0, 0, 0, 0, 0, 11],
            [0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
            [0, 25, 0, 12, 1, 0, 1, 0, 0, 1529, 0, 611, 0, 0, 0, 113, 0, 38, 1, 1, 5, 24, 4, 40, 7, 24],
            [0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 3, 4, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 19, 0, 15, 2, 0, 0, 0, 0, 1203, 0, 932, 0, 0, 0, 108, 2, 40, 1, 1, 8, 21, 1, 50, 14, 13],
            [0, 2, 0, 3, 0, 0, 0, 0, 0, 2, 0, 0, 48, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 28, 0, 13, 1, 22, 1, 5, 0, 7, 0, 2, 37, 2173, 1, 42, 0, 47, 4, 17, 0, 1, 1, 3, 0, 0],
            [0, 3, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 7, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 389, 0, 69, 0, 23, 1, 3, 0, 57, 0, 22, 0, 38, 4, 1177, 3, 651, 0, 0, 0, 0, 0, 4, 1, 5],
            [0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 365, 0, 75, 1, 13, 3, 6, 0, 47, 0, 19, 6, 31, 4, 875, 2, 984, 0, 1, 0, 1, 3, 5, 1, 5],
            [0, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 11, 0, 0, 0, 0, 139, 113, 0, 0, 0, 0, 0, 0],
            [0, 9, 0, 12, 0, 1, 0, 0, 0, 0, 0, 0, 2, 40, 0, 0, 0, 1, 44, 2101, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 27, 20, 1, 19, 0, 0],
            [0, 10, 0, 3, 0, 4, 0, 0, 0, 60, 0, 30, 0, 1, 1, 7, 0, 8, 1, 0, 27, 1683, 21, 554, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 2, 30, 19, 19, 1, 0],
            [0, 23, 0, 10, 1, 0, 0, 0, 0, 76, 0, 26, 0, 2, 0, 14, 0, 10, 2, 0, 26, 1234, 13, 964, 2, 0],
            [0, 1, 0, 1, 0, 3, 0, 4, 0, 2, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 134, 87],
            [0, 1, 0, 1, 1, 9, 1, 5, 0, 19, 0, 6, 0, 0, 0, 1, 0, 2, 0, 0, 0, 3, 0, 4, 131, 2061]]

    clip_EN = [[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 6, 0, 0, 0, 92, 0, 1189, 0, 0, 0, 0, 0, 1158, 0, 0, 0, 0, 0, 4, 0, 1, 0, 0, 0, 12],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 3, 0, 0, 0, 79, 0, 1214, 0, 0, 0, 0, 0, 1141, 0, 0, 0, 0, 0, 5, 0, 1, 0, 0, 0, 19],
            [0, 1, 0, 0, 0, 11, 0, 74, 0, 0, 0, 0, 0, 46, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10],
            [0, 0, 0, 0, 0, 151, 0, 1316, 0, 0, 0, 0, 0, 829, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24],
            [0, 1, 0, 0, 0, 9, 0, 75, 0, 0, 0, 0, 0, 49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14],
            [0, 1, 0, 0, 0, 0, 0, 1662, 0, 0, 0, 0, 0, 610, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41],
            [0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [0, 0, 0, 0, 0, 75, 0, 1191, 0, 0, 0, 0, 0, 1138, 0, 0, 0, 0, 0, 9, 0, 2, 0, 0, 0, 21],
            [0, 0, 0, 0, 0, 2, 0, 6, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 1, 0, 0, 0, 68, 0, 1257, 0, 0, 0, 0, 0, 1088, 0, 0, 0, 1, 0, 3, 0, 0, 0, 0, 0, 12],
            [0, 0, 0, 0, 0, 3, 0, 41, 0, 0, 0, 0, 3, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [0, 0, 0, 0, 0, 114, 0, 1006, 0, 0, 0, 0, 0, 1283, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
            [0, 0, 0, 0, 0, 1, 0, 8, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 1, 0, 185, 0, 1662, 0, 0, 0, 0, 0, 586, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 10],
            [0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 1, 0, 158, 0, 1597, 0, 0, 0, 0, 0, 662, 0, 2, 0, 0, 0, 9, 0, 0, 0, 0, 0, 18],
            [0, 0, 0, 0, 0, 61, 0, 186, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 3],
            [0, 0, 0, 0, 0, 324, 0, 1655, 0, 0, 0, 0, 0, 200, 0, 0, 0, 0, 0, 18, 0, 0, 0, 0, 0, 13],
            [0, 0, 0, 0, 0, 1, 0, 28, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [0, 0, 0, 0, 0, 84, 0, 1077, 0, 0, 0, 0, 0, 1220, 0, 1, 0, 0, 0, 4, 0, 3, 0, 0, 0, 21],
            [0, 0, 0, 0, 0, 3, 0, 36, 0, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
            [0, 0, 0, 0, 0, 75, 0, 1238, 0, 0, 0, 0, 1, 1068, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 16],
            [0, 0, 0, 1, 0, 11, 0, 72, 0, 0, 0, 0, 0, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 49],
            [0, 0, 0, 0, 0, 66, 0, 600, 0, 0, 0, 0, 0, 1116, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 462]]
    # 绘制热力图
    plt.figure(figsize=(14.5, 11.5))
    sns.heatmap(clip_EN, annot=True, fmt='d', cmap='YlGnBu', xticklabels=x_labels, yticklabels=y_labels)
    plt.title('Confusion Matrix', fontsize=20)
    plt.xlabel('Predicted Labels', fontsize=20)
    plt.ylabel('True Labels', fontsize=20)
    plt.show()

def regionheatmap():
    x_labels = ['ankleL', 'ankleR', 'chestL', 'chestR', 'elbowL', 'elbowR', 'head', 'kneeL', 'kneeR', 'pelvis', 'shoulderL', 'shoulderR', 'vertebra']
    y_labels = ['ankleL', 'ankleR', 'chestL', 'chestR', 'elbowL', 'elbowR', 'head', 'kneeL', 'kneeR', 'pelvis', 'shoulderL', 'shoulderR', 'vertebra']

    blip_CN = [[1313, 1138, 1, 0, 0, 0, 0, 5, 4, 3, 0, 0, 0],
            [937, 1516, 1, 0, 0, 0, 0, 5, 1, 4, 0, 0, 0],
            [0, 0, 949, 1513, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 215, 2247, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [4, 10, 34, 3, 698, 1080, 108, 430, 35, 34, 0, 0, 6],
            [5, 7, 40, 4, 533, 1182, 121, 383, 52, 99, 1, 0, 3],
            [0, 0, 0, 0, 0, 0, 2479, 0, 0, 1, 0, 0, 0],
            [2, 1, 4, 4, 0, 0, 2, 1479, 958, 12, 0, 0, 1],
            [0, 1, 3, 6, 0, 0, 5, 1172, 1269, 8, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 2476, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 6, 2, 1252, 1220, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 871, 1606, 0],
            [1, 4, 23, 60, 18, 4, 29, 0, 0, 0, 6, 0, 2335]]

    
    clip_CN = [[2, 0, 64, 0, 34, 0, 2341, 3, 0, 0, 8, 0, 12],
          [2, 0, 78, 0, 59, 0, 2294, 11, 1, 0, 7, 0, 12],
          [0, 0, 1349, 0, 18, 0, 795, 0, 0, 2, 160, 5, 133],
          [0, 0, 1432, 1, 62, 0, 580, 0, 0, 0, 234, 1, 152],
          [241, 0, 79, 2, 2, 0, 479, 1624, 2, 9, 2, 0, 2],
          [242, 0, 93, 2, 8, 0, 479, 1602, 3, 9, 2, 0, 1],
          [1, 0, 11, 0, 9, 0, 2416, 11, 2, 0, 0, 0, 0],
          [0, 0, 10, 0, 7, 0, 2418, 28, 0, 0, 0, 0, 1],
          [0, 0, 58, 2, 0, 0, 2041, 1, 0, 273, 98, 1, 2],
          [1, 0, 40, 0, 1597, 0, 473, 0, 0, 0, 359, 10, 0],
          [0, 0, 42, 0, 1574, 0, 381, 0, 0, 0, 467, 16, 0],
          [0, 0, 1126, 1, 10, 0, 155, 0, 0, 0, 14, 2, 1172]]

    blip_EN = [[1736, 44, 20, 1, 153, 58, 5, 225, 101, 1, 33, 64, 23],
            [1437, 278, 10, 4, 124, 58, 13, 255, 140, 0, 37, 93, 15],
            [71, 4, 1683, 626, 2, 1, 34, 20, 7, 1, 1, 2, 10],
            [30, 6, 954, 1425, 0, 0, 26, 6, 3, 0, 0, 0, 12],
            [26, 13, 1, 1, 1531, 612, 0, 113, 38, 2, 29, 44, 32],
            [20, 15, 2, 0, 1205, 939, 0, 109, 42, 2, 29, 51, 27],
            [30, 16, 23, 6, 9, 2, 2278, 43, 47, 21, 1, 4, 0],
            [392, 70, 23, 4, 58, 22, 39, 1190, 655, 0, 0, 4, 6],
            [369, 75, 14, 9, 47, 19, 37, 882, 996, 1, 1, 8, 6],
            [11, 12, 2, 0, 0, 0, 53, 0, 1, 2397, 0, 0, 0],
            [10, 3, 4, 0, 62, 31, 1, 8, 8, 1, 1757, 595, 0],
            [23, 10, 1, 0, 79, 29, 2, 14, 10, 2, 1292, 1015, 3],
            [2, 2, 13, 10, 21, 6, 1, 3, 2, 0, 3, 4, 2413]]

    clip_EN = [[6, 0, 92, 1190, 0, 0, 1159, 0, 0, 4, 1, 0, 12],
            [3, 0, 79, 1214, 0, 0, 1143, 0, 0, 5, 1, 0, 19],
            [1, 0, 162, 1390, 0, 0, 875, 0, 0, 0, 0, 0, 34],
            [2, 0, 9, 1737, 0, 0, 659, 0, 0, 0, 0, 0, 55],
            [0, 0, 75, 1193, 0, 0, 1141, 0, 0, 9, 2, 0, 22],
            [1, 0, 70, 1263, 0, 0, 1091, 0, 1, 3, 0, 0, 12],
            [0, 0, 117, 1047, 0, 0, 1313, 0, 0, 0, 0, 0, 3],
            [0, 1, 186, 1670, 0, 0, 593, 0, 0, 3, 0, 0, 10],
            [0, 1, 158, 1607, 0, 0, 669, 2, 0, 9, 0, 0, 18],
            [0, 0, 385, 1841, 0, 0, 215, 0, 0, 19, 0, 0, 16],
            [0, 0, 85, 1105, 0, 0, 1260, 1, 0, 4, 3, 0, 22],
            [0, 0, 78, 1274, 0, 0, 1105, 0, 0, 5, 0, 0, 18],
            [0, 1, 77, 672, 0, 0, 1217, 1, 0, 0, 0, 0, 512]]
    # 绘制热力图
    plt.figure(figsize=(12, 10.5))
    sns.heatmap(clip_EN, annot=True, fmt='d', cmap='YlGnBu', xticklabels=x_labels, yticklabels=y_labels)
    plt.title('Confusion Matrix', fontsize=20)
    plt.xlabel('Predicted Labels', fontsize=20)
    plt.ylabel('True Labels', fontsize=20)
    plt.show()


# def barchart():



if __name__ == '__main__':
    wordcloudraw()
    # heatmap()
    # barchart()
    # regionheatmap()
    # confusion_matrix_heatmap()